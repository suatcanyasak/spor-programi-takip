document.addEventListener("DOMContentLoaded",(()=>{let e=JSON.parse(localStorage.getItem("myWorkouts"))||{Pazartesi:[],SalÄ±:[],Ã‡arÅŸamba:[],PerÅŸembe:[],Cuma:[],Cumartesi:[],Pazar:[]};const t=()=>{localStorage.setItem("myWorkouts",JSON.stringify(e)),n()};document.getElementById("add-btn").onclick=()=>{const n=document.getElementById("day-select").value,o=document.getElementById("exercise-name").value,a=document.getElementById("sets").value,r=document.getElementById("value-per-set").value,i=document.getElementById("exercise-weight").value;if(!o||!a||!r)return alert("BoÅŸ alan bÄ±rakmayÄ±n!");e[n].push({id:Date.now(),name:o,weight:i||0,sets:parseInt(a),type:"reps"===document.getElementById("type-select").value?"Tekrar":"Dakika",value:parseInt(r),completed:!1}),t(),["exercise-name","exercise-weight","sets","value-per-set"].forEach((e=>document.getElementById(e).value=""))};const n=()=>{const o=document.getElementById("daily-planner");if(o){o.innerHTML="",Object.keys(e).forEach((t=>{const a=e[t],r=a.filter((e=>e.completed)).length,i=a.length>0?Math.round(r/a.length*100):0,l=document.createElement("div");l.className="day-card card",l.innerHTML=`<h4>${t} <span class="perc">%${i}</span></h4><div class="exercise-list"></div>`,a.forEach((o=>{const a=document.createElement("div");a.className=`exercise-item ${o.completed?"completed":""}`,a.innerHTML=`<div style="flex:1"><strong>${o.name}</strong><br><small><span class="inline-edit" data-id="${o.id}" data-day="${t}" data-field="weight">${o.weight||0}</span>kg | <span class="inline-edit" data-id="${o.id}" data-day="${t}" data-field="sets">${o.sets}</span>x<span class="inline-edit" data-id="${o.id}" data-day="${t}" data-field="value">${o.value}</span> ${o.type}</small></div><div class="actions"><input type="checkbox" ${o.completed?"checked":""}><button class="btn-delete" data-day="${t}" data-id="${o.id}">ğŸ—‘ï¸</button></div>`,a.querySelector("input").onchange=t=>{o.completed=t.target.checked,localStorage.setItem("myWorkouts",JSON.stringify(e)),n()},l.querySelector(".exercise-list").appendChild(a)})),o.appendChild(l)})),document.querySelectorAll(".inline-edit").forEach((t=>{t.style.cursor="pointer",t.style.borderBottom="1px dashed var(--primary)",t.onclick=function(){if(this.querySelector("input"))return;const n=this.innerText,o=this.getAttribute("data-field"),a=this.getAttribute("data-id"),r=this.getAttribute("data-day"),i=document.createElement("input");i.type="number",i.value=n,i.style.width="45px",i.style.fontSize="12px",i.style.background="var(--input-bg)",i.style.color="var(--text)",this.innerText="",this.appendChild(i),i.focus();const l=()=>{const n=i.value||0,s=e[r].find((e=>e.id==a));s&&(s[o]="weight"===o?n:parseInt(n)),localStorage.setItem("myWorkouts",JSON.stringify(e)),this.innerHTML=n,c()};i.onblur=l,i.onkeydown=e=>{"Enter"===e.key&&i.blur()}}})),document.querySelectorAll(".btn-delete").forEach((n=>{n.onclick=()=>{const o=n.getAttribute("data-day"),a=n.getAttribute("data-id");e[o]=e[o].filter((e=>e.id!=a)),t()}})),c()}};const c=()=>{const t=document.getElementById("total-progress-bar");let n=0,o=0;Object.values(e).forEach((e=>{n+=e.length,o+=e.filter((e=>e.completed)).length})),t&&(t.style.width=(n>0?o/n*100:0)+"%")};document.querySelectorAll(".exercise-guide li:not(.category-title)").forEach((e=>{e.onclick=()=>{document.getElementById("exercise-name").value=e.innerText,document.getElementById("exercise-name").focus()}})),document.getElementById("download-pdf").onclick=()=>{const t=document.getElementById("total-progress-bar").style.width;let n=`<div style="padding:20px;font-family:sans-serif;color:#333;"><div style="text-align:center;border-bottom:3px solid #4f46e5;padding-bottom:10px;margin-bottom:20px;"><h1 style="color:#4f46e5;margin:0;">WeeklyGym Raporu</h1><p>HaftalÄ±k BaÅŸarÄ±: %${parseInt(t)||0}</p></div>`;Object.keys(e).forEach((t=>{e[t].length>0&&(n+=`<h3>${t}</h3><table style="width:100%;border-collapse:collapse;margin-top:10px;"><thead><tr style="background:#f8fafc;border-bottom:2px solid #ddd;text-align:left;"><th style="padding:8px;">Egzersiz</th><th style="padding:8px;">Detay</th><th style="padding:8px;text-align:center;">Durum</th></tr></thead><tbody>`,e[t].forEach((e=>{const t=e.completed?"TAMAMLANDI":"EKSÄ°K",o=e.completed?"#10b981":"#ef4444";n+=`<tr style="border-bottom:1px solid #eee;"><td style="padding:10px;"><b>${e.name}</b></td><td style="padding:10px;">${e.weight?e.weight+"kg | ":""}${e.sets}x${e.value}</td><td style="padding:10px;text-align:center;font-weight:bold;color:${o};">${t}</td></tr>`})),n+="</tbody></table>")})),n+="</div>";const o=document.createElement("div");o.innerHTML=n,html2pdf().set({margin:10,filename:"WeeklyGym_Rapor.pdf",image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}}).from(o).save()},document.getElementById("theme-toggle").onclick=()=>{document.body.classList.toggle("light-mode"),localStorage.setItem("theme",document.body.classList.contains("light-mode")?"light":"dark")},"light"===localStorage.getItem("theme")&&document.body.classList.add("light-mode"),document.getElementById("reset-all").onclick=()=>{confirm("TÃ¼m program silinsin mi?")&&(Object.keys(e).forEach((t=>e[t]=[])),t())},n()}));
